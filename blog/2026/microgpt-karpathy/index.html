<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Deep Dive into MicroGPT by Karpathy | Eren Arxiv. </title> <meta name="author" content="Eren Lee"> <meta name="description" content="A detailed walkthrough of Karpathy's MicroGPT, covering dataset preparation, character-level tokenization, a minimal autograd engine (the Value class), Python special methods, and backpropagation via topological sort."> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https:; style-src 'self' 'unsafe-inline' https:; img-src 'self' data: https:; font-src 'self' data: https:; media-src 'self' https:; frame-src 'self' https:; connect-src 'self' https:;"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?v=a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?v=f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?v=62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?v=591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/eren.png?v=d0d72ff48d06f448f928e135ff9066d6"> <link rel="stylesheet" href="/assets/css/main.css?v=d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://qwertyyuiop1234.github.io/blog/2026/microgpt-karpathy/"> <script src="/assets/js/theme.js?v=5fea5159b787642c1bbc1f334d60f883"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?v=5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> Eren Arxiv. </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="fa-solid fa-magnifying-glass"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-half-sun-moon" id="light-toggle-system"></i> <i class="fa-solid fa-moon" id="light-toggle-dark"></i> <i class="fa-solid fa-sun" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Deep Dive into MicroGPT by Karpathy</h1> <p class="post-meta"> Created on February 17, 2026 </p> <p class="post-tags"> <a href="/blog/2026"> <i class="fa-solid fa-calendar fa-sm"></i> 2026 </a>   ·   <a href="/blog/tag/microgpt"> <i class="fa-solid fa-hashtag fa-sm"></i> microgpt</a>   <a href="/blog/tag/karpathy"> <i class="fa-solid fa-hashtag fa-sm"></i> karpathy</a>   <a href="/blog/tag/autograd"> <i class="fa-solid fa-hashtag fa-sm"></i> autograd</a>   <a href="/blog/tag/backpropagation"> <i class="fa-solid fa-hashtag fa-sm"></i> backpropagation</a>   <a href="/blog/tag/nlp"> <i class="fa-solid fa-hashtag fa-sm"></i> nlp</a>   ·   <a href="/blog/category/ai"> <i class="fa-solid fa-tag fa-sm"></i> AI</a>   <a href="/blog/category/nlp"> <i class="fa-solid fa-tag fa-sm"></i> NLP</a> </p> </header> <article class="post-content"> <div id="table-of-contents"> <ul id="toc" class="section-nav"> <li class="toc-entry toc-h1"> <a href="#1-getting-datasets--tokenizer">1. Getting Datasets &amp; Tokenizer</a> <ul> <li class="toc-entry toc-h2"><a href="#11-download-dataset">1.1 Download Dataset</a></li> <li class="toc-entry toc-h2"><a href="#12-tokenizer">1.2 Tokenizer</a></li> </ul> </li> <li class="toc-entry toc-h1"> <a href="#2-computation-graph">2. Computation Graph</a> <ul> <li class="toc-entry toc-h2"><a href="#21-why-__slots__">2.1 Why __slots__?</a></li> <li class="toc-entry toc-h2"> <a href="#22-special-methods">2.2 Special Methods</a> <ul> <li class="toc-entry toc-h3"><a href="#221-normal-methods-vs-reflected-methods">2.2.1 Normal Methods vs. Reflected Methods</a></li> <li class="toc-entry toc-h3"><a href="#222-why-__sub__-uses---other-instead-of-direct-subtraction">2.2.2 Why __sub__ Uses + (-other) Instead of Direct Subtraction</a></li> </ul> </li> </ul> </li> </ul> </div> <hr> <div id="markdown-content"> <p>In this post, I’m reviewing <a href="https://karpathy.github.io/2026/02/12/microgpt/" target="\_blank" rel="external nofollow noopener"><strong>MicroGPT by Andrej Karpathy</strong></a>, which is an essential resource for anyone interested in understanding how language models work from scratch.</p> <hr> <h1 id="1-getting-datasets--tokenizer">1. Getting Datasets &amp; Tokenizer</h1> <h2 id="11-download-dataset">1.1 Download Dataset</h2> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Let there be a Dataset `docs`: list[str] of documents (e.g. a list of names)
</span><span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">exists</span><span class="p">(</span><span class="sh">'</span><span class="s">input.txt</span><span class="sh">'</span><span class="p">):</span>
    <span class="kn">import</span> <span class="n">urllib.request</span>
    <span class="n">names_url</span> <span class="o">=</span> <span class="sh">'</span><span class="s">https://raw.githubusercontent.com/karpathy/makemore/988aa59/names.txt</span><span class="sh">'</span>
    <span class="n">urllib</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="nf">urlretrieve</span><span class="p">(</span><span class="n">names_url</span><span class="p">,</span> <span class="sh">'</span><span class="s">input.txt</span><span class="sh">'</span><span class="p">)</span>
<span class="n">docs</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="p">.</span><span class="nf">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nf">open</span><span class="p">(</span><span class="sh">'</span><span class="s">input.txt</span><span class="sh">'</span><span class="p">)</span> <span class="k">if</span> <span class="n">line</span><span class="p">.</span><span class="nf">strip</span><span class="p">()]</span>
<span class="n">random</span><span class="p">.</span><span class="nf">shuffle</span><span class="p">(</span><span class="n">docs</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">num docs: </span><span class="si">{</span><span class="nf">len</span><span class="p">(</span><span class="n">docs</span><span class="p">)</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>  <span class="c1"># total number of names is 32,033
</span></code></pre></div></div> <p><code class="language-plaintext highlighter-rouge">urllib.request</code> is a Python standard library module for fetching data from URLs.</p> <p>The dataset consists of 32,033 human names, each on a separate line. After loading, the names are stripped of whitespace and shuffled randomly.</p> <p><br></p> <h2 id="12-tokenizer">1.2 Tokenizer</h2> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Let there be a Tokenizer to translate strings to sequences of integers ("tokens") and back
</span><span class="n">uchars</span> <span class="o">=</span> <span class="nf">sorted</span><span class="p">(</span><span class="nf">set</span><span class="p">(</span><span class="sh">''</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">docs</span><span class="p">)))</span>  <span class="c1"># unique characters in the dataset become token ids 0..n-1
</span><span class="n">BOS</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">uchars</span><span class="p">)</span>  <span class="c1"># token id for a special Beginning of Sequence (BOS) token
</span><span class="n">vocab_size</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">uchars</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>  <span class="c1"># total number of unique tokens, +1 is for BOS
</span><span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">vocab size: </span><span class="si">{</span><span class="n">vocab_size</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div> <ul> <li> <code class="language-plaintext highlighter-rouge">uchars</code> is the sorted set of all unique characters that appear across the names in <code class="language-plaintext highlighter-rouge">input.txt</code>. Each character is assigned a token ID from <code class="language-plaintext highlighter-rouge">0</code> to <code class="language-plaintext highlighter-rouge">n-1</code>.</li> <li> <code class="language-plaintext highlighter-rouge">vocab_size</code> is <code class="language-plaintext highlighter-rouge">len(uchars) + 1</code> because we need one additional ID for the <strong>BOS</strong> token. Every token — including special tokens — requires its own unique ID in the vocabulary.</li> </ul> <blockquote> <p><strong>What is BOS (Beginning of Sequence)?</strong></p> <p>BOS is a special token that marks the start of a sequence. During <strong>generation</strong>, the model receives the BOS token as its initial input to begin producing the first real character. Without BOS, the model would have no starting signal and could not initiate generation.</p> <p>In this character-level model, BOS is the <em>only</em> special token — and it <strong>doubles as the EOS (End of Sequence) token</strong>. Each name is wrapped like this:</p> <p><code class="language-plaintext highlighter-rouge">[BOS] e m m a [BOS]</code></p> <p>The same token appears at both the beginning and the end. During generation, when the model predicts BOS as the next token, that signals the name is complete and generation stops. This is an elegant design: a single special token handles both roles, keeping the vocabulary minimal.</p> </blockquote> <p>For a deeper understanding of tokenization strategies, see: <a href="https://nebius.com/blog/posts/how-tokenizers-work-in-ai-models" target="\_blank" rel="external nofollow noopener">How Tokenizers Work in AI Models (Nebius)</a></p> <hr> <h1 id="2-computation-graph">2. Computation Graph</h1> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Let there be Autograd to recursively apply the chain rule through a computation graph
</span><span class="k">class</span> <span class="nc">Value</span><span class="p">:</span>
    <span class="n">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="sh">'</span><span class="s">data</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">grad</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">_children</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">_local_grads</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div> <p><br></p> <h2 id="21-why-__slots__">2.1 Why <code class="language-plaintext highlighter-rouge">__slots__</code>?</h2> <p>In a standard Python class, instance attributes are stored in a per-instance <code class="language-plaintext highlighter-rouge">__dict__</code> dictionary. This is flexible but comes with overhead: each dictionary maintains a hash table, keys, values, and internal bookkeeping.</p> <p><strong>Without <code class="language-plaintext highlighter-rouge">__slots__</code></strong> (default):</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>instance
  └── __dict__  (a full hash-table dictionary)
        ├── key → value
        ├── key → value
        └── ...
</code></pre></div></div> <p><strong>With <code class="language-plaintext highlighter-rouge">__slots__</code></strong>:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>instance
  └── fixed attribute slots  (C-struct-like, no dictionary)
        ├── data
        ├── grad
        ├── _children
        └── _local_grads
</code></pre></div></div> <p>By declaring <code class="language-plaintext highlighter-rouge">__slots__</code>, Python allocates a <strong>fixed-size struct</strong> for the listed attributes instead of a dictionary. This:</p> <ul> <li> <strong>Saves memory</strong> — no dictionary overhead per instance (important when creating thousands of <code class="language-plaintext highlighter-rouge">Value</code> nodes in a computation graph).</li> <li> <strong>Speeds up attribute access</strong> — direct offset-based lookup instead of hash-table lookup.</li> <li> <strong>Prevents accidental attribute creation</strong> — assigning to a non-declared attribute raises <code class="language-plaintext highlighter-rouge">AttributeError</code>.</li> </ul> <p><br></p> <h2 id="22-special-methods">2.2 Special Methods</h2> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">children</span><span class="o">=</span><span class="p">(),</span> <span class="n">local_grads</span><span class="o">=</span><span class="p">()):</span>
    <span class="n">self</span><span class="p">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>                <span class="c1"># scalar value of this node (computed during forward pass)
</span>    <span class="n">self</span><span class="p">.</span><span class="n">grad</span> <span class="o">=</span> <span class="mi">0</span>                   <span class="c1"># derivative of loss w.r.t. this node (computed during backward pass)
</span>    <span class="n">self</span><span class="p">.</span><span class="n">_children</span> <span class="o">=</span> <span class="n">children</span>       <span class="c1"># children of this node in the computation graph
</span>    <span class="n">self</span><span class="p">.</span><span class="n">_local_grads</span> <span class="o">=</span> <span class="n">local_grads</span> <span class="c1"># local derivatives of this node w.r.t. its children
</span>
<span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
    <span class="n">other</span> <span class="o">=</span> <span class="n">other</span> <span class="k">if</span> <span class="nf">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Value</span><span class="p">)</span> <span class="k">else</span> <span class="nc">Value</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
    <span class="k">return</span> <span class="nc">Value</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">data</span> <span class="o">+</span> <span class="n">other</span><span class="p">.</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">other</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">__mul__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
    <span class="n">other</span> <span class="o">=</span> <span class="n">other</span> <span class="k">if</span> <span class="nf">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Value</span><span class="p">)</span> <span class="k">else</span> <span class="nc">Value</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
    <span class="k">return</span> <span class="nc">Value</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">data</span> <span class="o">*</span> <span class="n">other</span><span class="p">.</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">other</span><span class="p">),</span> <span class="p">(</span><span class="n">other</span><span class="p">.</span><span class="n">data</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">data</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">__pow__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span> <span class="k">return</span> <span class="nc">Value</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">data</span><span class="o">**</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="n">self</span><span class="p">,),</span> <span class="p">(</span><span class="n">other</span> <span class="o">*</span> <span class="n">self</span><span class="p">.</span><span class="n">data</span><span class="o">**</span><span class="p">(</span><span class="n">other</span><span class="o">-</span><span class="mi">1</span><span class="p">),))</span>
<span class="k">def</span> <span class="nf">log</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>  <span class="k">return</span> <span class="nc">Value</span><span class="p">(</span><span class="n">math</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">data</span><span class="p">),</span> <span class="p">(</span><span class="n">self</span><span class="p">,),</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">self</span><span class="p">.</span><span class="n">data</span><span class="p">,))</span>
<span class="k">def</span> <span class="nf">exp</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>  <span class="k">return</span> <span class="nc">Value</span><span class="p">(</span><span class="n">math</span><span class="p">.</span><span class="nf">exp</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">data</span><span class="p">),</span> <span class="p">(</span><span class="n">self</span><span class="p">,),</span> <span class="p">(</span><span class="n">math</span><span class="p">.</span><span class="nf">exp</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">data</span><span class="p">),))</span>
<span class="k">def</span> <span class="nf">relu</span><span class="p">(</span><span class="n">self</span><span class="p">):</span> <span class="k">return</span> <span class="nc">Value</span><span class="p">(</span><span class="nf">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">data</span><span class="p">),</span> <span class="p">(</span><span class="n">self</span><span class="p">,),</span> <span class="p">(</span><span class="nf">float</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">data</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">),))</span>
<span class="k">def</span> <span class="nf">__neg__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>      <span class="k">return</span> <span class="n">self</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span>
<span class="k">def</span> <span class="nf">__radd__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span> <span class="k">return</span> <span class="n">self</span> <span class="o">+</span> <span class="n">other</span>
<span class="k">def</span> <span class="nf">__sub__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>  <span class="k">return</span> <span class="n">self</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">other</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">__rsub__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span> <span class="k">return</span> <span class="n">other</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">self</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">__rmul__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span> <span class="k">return</span> <span class="n">self</span> <span class="o">*</span> <span class="n">other</span>
<span class="k">def</span> <span class="nf">__truediv__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>  <span class="k">return</span> <span class="n">self</span> <span class="o">*</span> <span class="n">other</span><span class="o">**-</span><span class="mi">1</span>
<span class="k">def</span> <span class="nf">__rtruediv__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span> <span class="k">return</span> <span class="n">other</span> <span class="o">*</span> <span class="n">self</span><span class="o">**-</span><span class="mi">1</span>
</code></pre></div></div> <p>Each operation creates a new <code class="language-plaintext highlighter-rouge">Value</code> node that records:</p> <ol> <li>The <strong>forward result</strong> (<code class="language-plaintext highlighter-rouge">data</code>)</li> <li>Its <strong>parent operands</strong> (<code class="language-plaintext highlighter-rouge">_children</code>)</li> <li>The <strong>local gradients</strong> (<code class="language-plaintext highlighter-rouge">_local_grads</code>) — partial derivatives of this operation’s output with respect to each child</li> </ol> <p>This builds a <strong>computation graph</strong> during the forward pass that will later be traversed in reverse for backpropagation.</p> <p><br></p> <h3 id="221-normal-methods-vs-reflected-methods">2.2.1 Normal Methods vs. Reflected Methods</h3> <p>Consider <code class="language-plaintext highlighter-rouge">__add__</code> and <code class="language-plaintext highlighter-rouge">__radd__</code>. Why do we need the reflected (reverse) version?</p> <p>When Python evaluates <code class="language-plaintext highlighter-rouge">3 + Value(5)</code>:</p> <ol> <li>Python first tries <code class="language-plaintext highlighter-rouge">int.__add__(3, Value(5))</code> → <code class="language-plaintext highlighter-rouge">int</code> doesn’t know how to add a <code class="language-plaintext highlighter-rouge">Value</code>, so it returns <code class="language-plaintext highlighter-rouge">NotImplemented</code>.</li> <li>Python then falls back to <code class="language-plaintext highlighter-rouge">Value.__radd__(Value(5), 3)</code> → this works because <code class="language-plaintext highlighter-rouge">__radd__</code> calls <code class="language-plaintext highlighter-rouge">self + other</code>, which triggers <code class="language-plaintext highlighter-rouge">Value.__add__</code>.</li> </ol> <p>Without <code class="language-plaintext highlighter-rouge">__radd__</code>, expressions like <code class="language-plaintext highlighter-rouge">3 + Value(5)</code> or <code class="language-plaintext highlighter-rouge">2 * Value(3)</code> would raise a <code class="language-plaintext highlighter-rouge">TypeError</code>.</p> <p><br></p> <h3 id="222-why-__sub__-uses---other-instead-of-direct-subtraction">2.2.2 Why <code class="language-plaintext highlighter-rouge">__sub__</code> Uses <code class="language-plaintext highlighter-rouge">+ (-other)</code> Instead of Direct Subtraction</h3> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">__sub__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span> <span class="k">return</span> <span class="n">self</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">other</span><span class="p">)</span>
</code></pre></div></div> <p>This might look roundabout, but it’s a deliberate design choice:</p> <ul> <li> <strong>Reuses existing operations</strong>: Subtraction is decomposed into negation (<code class="language-plaintext highlighter-rouge">__neg__</code>) and addition (<code class="language-plaintext highlighter-rouge">__add__</code>), both of which are already implemented with correct gradient tracking.</li> <li> <strong>Avoids redundant gradient logic</strong>: If subtraction were implemented as a separate operation, we would need to define and maintain additional local gradient formulas.</li> <li> <strong>Keeps the computation graph simple</strong>: Every operation in the graph maps to one of a small set of primitives (<code class="language-plaintext highlighter-rouge">add</code>, <code class="language-plaintext highlighter-rouge">mul</code>, <code class="language-plaintext highlighter-rouge">pow</code>, <code class="language-plaintext highlighter-rouge">log</code>, <code class="language-plaintext highlighter-rouge">exp</code>, <code class="language-plaintext highlighter-rouge">relu</code>), making the backward pass straightforward.</li> </ul> <p><br></p> <hr> <p><em>This post will be updated as I continue studying the remaining sections of MicroGPT.</em></p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2026/cs231n-softmax/">[CS231n] Assignment 1 - Q2. Implement a Softmax Classifier</a> </li> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2026 Eren Lee. Last updated: February 17, 2026. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?v=a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?v=85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?v=2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?v=c15de51d4bb57887caa2c21988d97279"></script> <script defer src="/assets/js/copy_code.js?v=c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?v=d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?v=a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?v=2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?v=f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?v=a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?v=6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?v=ccc841c459bfc0e64c1c2b5acd10df02"></script> </body> </html>